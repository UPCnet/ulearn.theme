<div id="box_agenda" class="ulearnbox">
  <div class="osomcorner-wrapper"><div class="osomcorner"></div></div>

  <h2>Agenda</h2>
  <div id="agenda" class="row-fluid"
       tal:define="today view/today">
    <div id="day" class="bubble left span5">
      <div class="arrow"></div>
      <div class="bubble-content">
        <p tal:content="today/number">14</p>
        <p class="data"
           tal:content="today/weekday">Jueves</p>
      </div>
    </div>

    <div id="esdev" class="span6"
         tal:define="today_event view/get_nearest_today_event">
          <div class="vertical_aligned">
            <a href="#"
              tal:condition="today_event"
              tal:content="today_event/Title"
              tal:attributes="href today_event/getURL">Desayuno de trabajo: aportando valores a la formaci√≥n...</a>
            <a href="#"
              tal:condition="not: today_event"
              i18n:domain="ulearn"
              i18n:translate="not_events_for_today">There are not events today</a>
          </div>
    </div>
  </div>

  <div id="calendari" class="portletCalendar"
       tal:define="navigation_root_url context/@@plone_portal_state/navigation_root_url;
                   month view/month;
                   year view/year;">

    <div class="portletHeader">
      <span class="portletTopLeft"></span>
      <a href="#" rel="nofollow"
           class="calendarPrevious"
           title="Previous month"
           tal:define="prev_month view/prev_month;
                       prev_year view/prev_year"
           tal:attributes="href view/prev_query;
                           data-year prev_year;
                           data-month prev_month;"
           i18n:attributes="title title_previous_month;">&laquo;</a>

        <span i18n:translate="" tal:omit-tag="">
            <span i18n:name="monthname" i18n:translate=""
                  tal:content="view/month_name"
                  tal:omit-tag="">monthname</span>
            <span i18n:name="year" i18n:translate=""
                  tal:content="year"
                  tal:omit-tag="">year</span>
        </span>

        <a href="#" rel="nofollow"
           class="calendarNext"
           title="Next month"
           tal:define="next_month view/next_month;
                       next_year view/next_year"
           tal:attributes="href view/next_query;
                           data-year next_year;
                           data-month next_month;"
           i18n:attributes="title title_next_month;">&raquo;</a>
        <span class="portletTopRight"></span>
    </div>

        <table class="ploneCalendar" summary="Calendar"
            i18n:attributes="summary summary_calendar">
            <caption class="hiddenStructure"
                i18n:translate="" tal:content="string:month-${month}">monthname</caption>
            <thead>
              <tr class="weekdays"><tal:data repeat="weekday view/weekdays">
                <th scope="col" i18n:translate="" tal:content="weekday">Su</th>
              </tal:data></tr>
            </thead>
            <tbody>
              <tr tal:repeat="week view/cal_data">
                <tal:block repeat="day week">
                <td
                  tal:define="today day/today;
                              next_month day/next_month;
                              prev_month day/prev_month;
                              events day/events;
                              limit python:len(events) if events is not None else 0"
                  tal:attributes="class python:u'ulearnevent%s%s%s%s' %
                              ((today and ' today' or ''),
                              (next_month and ' cal_next_month' or ''),
                              (prev_month and ' cal_prev_month' or ''),
                              (events and ' cal_has_events' or ''))">
                    <a href=""
                      rel="popover" data-placement="bottom" data-html="True"
                      tal:omit-tag="not:events"
                      tal:attributes="href python:view.date_events_url(day['date_string']);
                                      data-content day/events_string;"
                      tal:content="day/day">31</a>

                </td>
                </tal:block>
              </tr>
            </tbody>
        </table>

<!--     <table class="ploneCalendar"
           summary="Calendar"
           i18n:domain="plone"
           i18n:attributes="summary summary_calendar;">
        <caption class="hiddenStructure"
                 tal:content="view/month">Month name</caption>
        <thead>
            <tr class="weekdays"
                ><tal:data tal:repeat="weekday view/weekdays"
                    ><th scope="col"
                         i18n:translate=""
                         tal:content="weekday">Su</th
                ></tal:data>
            </tr>
        </thead>
        <tbody>
            <tr tal:repeat="week view/cal_data"
                ><tal:block repeat="day week"
                    ><tal:day define="daynumber day/day;"
                        ><tal:isday condition="daynumber"
                            ><tal:block define="day_event day/event;
                                                is_today day/is_today"
                                ><td class="event"
                                    tal:condition="day_event"
                                    tal:attributes="class python:is_today and 'todayevent' or 'event'"
                                   ><strong><a href="" rel="tooltip" data-placement="top"
                                       tal:attributes="href string:${navigation_root_url}/@@search?advanced_search=True&amp;${view/getReviewStateString}start.query:record:list:date=${day/date_string}+23%3A59%3A59&amp;start.range:record=max&amp;end.query:record:list:date=${day/date_string}+00%3A00%3A00&amp;end.range:record=min&amp;Type=Event;
                                                       title day/eventstring;"
                                       tal:content="daynumber">
                                       31
                                   </a
                                ></strong></td
                                ><tal:notdayevent tal:condition="not: day_event"
                                    ><td tal:condition="python:is_today"
                                         class="todaynoevent"><strong
                                         tal:content="daynumber">31</strong></td
                                    ><td tal:condition="python:not is_today"
                                         tal:content="daynumber">31</td
                                ></tal:notdayevent
                            ></tal:block
                        ></tal:isday
                        ><tal:notisday condition="not: daynumber"
                            ><td></td
                        ></tal:notisday
                    ></tal:day
                ></tal:block>
            </tr>
        </tbody>

    </table>
     -->
  </div>

   <ul class="icons-ul">
    <li tal:repeat="event view/get_next_three_events">
      <a tal:attributes="href event/getURL">
        <i class="fa-icon-li fa-icon-calendar"></i>
        <tal:event content="event/Title">Event Title</tal:event>
      </a>
    </li>
  </ul>

  <p class="newevent"
     tal:condition="view/show_newevent_url">
    <a class="btn btn-large btn-comunitat"
       tal:attributes="href view/newevent_url">
        <i class="fa-icon-calendar-empty"></i>
        <tal:newevent  i18n:domain="ulearn" i18n:translate="newevent">Create a new event</tal:newevent>
    </a>
  </p>

</div>
