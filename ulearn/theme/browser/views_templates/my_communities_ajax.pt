<div id="communities-view" ng-controller="AllCommunities as ctrl">
  <section id="communitylist">
    <ul>
      <li dir-paginate="community in ctrl.user_communities | filter:q | itemsPerPage: ctrl.pageSize" current-page="ctrl.currentPage" ng-cloak>
        <div class="row-fluid">
          <div class="span2">
            <a ng-href="{{community.url}}">
              <img ng-if="community.image"
                   ng-src="{{community.url}}/@@images/image/thumb" />
              <img ng-if="!community.image"
                   src="/++ulearn++static/images/avatar_default.png" />
            </a>
          </div>
          <div class="span10">
            <a ng-href="{{community.url}}">
              <h4>{{community.title}}</h4>
              <p>{{community.description}}</p>
            </a>
          </div>
        </div>
        <div class="community-actions">
          <a class="community-action community-favorite community-icon-"
             ng-class="{'community-favorited': community.favorited}"
             ng-click="ctrl.toggleFavorite(community)">
             favorite
          </a>
          <a class="community-action community-subscribe community-icon-"
             ng-if="!ctrl.is_subscribed(community.url)"
             ng-class="{'community-subscribed': ctrl.is_subscribed(community.url)}"
             ng-click="ctrl.subscribe(community)" ng-cloak>
             subscribe
          </a>
          <a class="community-action community-subscribe community-icon-"
             ng-if="ctrl.is_subscribed(community.url) && !(community.type === 'Organizative')"
             ng-class="{'community-subscribed': ctrl.is_subscribed(community.url)}"
             ng-click="ctrl.unSubscribe(community)" ng-cloak>
             unsubscribe
          </a>
          <a class="community-action community-edit community-icon-"
             ng-if="community.can_manage"
             tal:attributes="href string:${context/absolute_url}/edit">edit</a>
          <a class="community-action community-delete community-icon-"
             ng-if="community.can_manage"
             ng-click="ctrl.delete(community)">delete</a>
        </div>
      </li>
    </ul>
  </section>
  <div class="pagination">
    <dir-pagination-controls boundary-links="true" tal:attributes="template-url string:${view/portal_url}/++components++ulearn/angular-utils-pagination/dirPagination.tpl.html"></dir-pagination-controls>
  </div>

</div>


<!--!
<section id="communitylist"
         tal:define="communities view/get_my_communities">
  <ul class="sortablelist"
      tal:condition="communities">
    <tal:community repeat="community communities">
      <li class="mix"
          tal:attributes="data-name community/Title">
        <div class="row-fluid">
          <div class="span2">
            <a tal:attributes="href community/getURL">
              <img tal:condition="community/image_filename"
                   tal:attributes="src string:${community/getURL}/@@images/image/thumb" />
              <img src="/++ulearn++static/images/avatar_default.png"
                   tal:condition="not: community/image_filename" />
            </a>
          </div>
          <div class="span7">
            <a tal:attributes="href community/getURL">
              <h4 tal:content="community/Title">Community</h4>
              <p tal:content="community/Description">Description</p>
            </a>
          </div>
          <div class="eines span3">
            <a class="favorite" href="#"
               tal:attributes="data-community string:${community/getURL}">
              <i tal:attributes="class python:view.get_star_class(community)"></i>
            </a>
            <a class="subscribe" href="#"
               tal:condition="python:view.is_not_organizative(community)"
               tal:attributes="data-community string:${community/getURL};
                               data-name community/Title">
              <i tal:attributes="class python:view.get_subscribed_class(community)"></i>
            </a>
            <a tal:condition="python:view.is_community_manager(community)"
               tal:attributes="href string:${community/getURL}/edit">
              <i class="fa fa-pencil"></i>
            </a>
            <a class="delete" href="#"
               tal:condition="python:view.is_community_manager(community)"
               tal:attributes="href string:${community/getURL}/delete_confirmation;
                               data-authenticator view/get_authenticator;
                               data-name community/Title">
            <i class="fa fa-times"></i>
            </a>
          </div>
        </div>
      </li>
    </tal:community>
  </ul>
  <p class="anycommunities"
     tal:condition="not:communities">
    <tal:msg i18n:domain="ulearn" i18n:translate="not_subscribed_to_any_community">
     You are not subscribed to any community yet.
    </tal:msg>
    <a tal:attributes="href string:${view/portal_url}/communities"
       i18n:domain="ulearn"
       i18n:translate="go_to_community_view">
      View the available communities.
    </a>
  </p>
</section>
 -->
