<script type="text/javascript">
// Mixitup initialize
// Rebind the favorites
$('.sortablelist').mixitup({layoutMode: 'list', onMixEnd: function () {
  $('.favorite').on('click', function(event) {
  event.preventDefault();
  var community_url = $(this).data()['community'];
  $.get(community_url + '/toggle-favorite');
  if ($('i', this).hasClass('fa-icon-star')) {
    $('i', this).addClass('fa-icon-star-empty').removeClass('fa-icon-star');
  } else {
    $('i', this).addClass('fa-icon-star').removeClass('fa-icon-star-empty');
  }
});
} })
</script>

<div class="clearfix">
  <div class="btn-group pull-right">
    <button class="btn sort" data-sort="data-name" data-order="asc"><i class="fa-icon-arrow-up"></i></button>
    <button class="btn sort" data-sort="data-name" data-order="desc"><i class="fa-icon-arrow-down"></i></button>
    <button class="btn sort" data-sort="default" data-order="desc"><i class="fa-icon-bullseye"></i></button>
  </div>
</div>

<section id="communitylist"
         tal:define="communities view/get_my_communities">
  <ul class="sortablelist">
    <tal:community repeat="community communities">
      <li class="mix"
          tal:attributes="data-name community/Title">
        <div class="row-fluid">
          <div class="span2">
            <a tal:attributes="href community/getURL">
              <img tal:condition="community/image_filename"
                   tal:attributes="src string:${community/getURL}/@@images/image/thumb" />
              <img src="/++ulearn++static/images/avatar_default.png"
                   tal:condition="not: community/image_filename" />
            </a>
          </div>
          <div class="span8">
            <a tal:attributes="href community/getURL">
              <h4 tal:content="community/Title">Community</h4>
              <p tal:content="community/Description">Description</p>
            </a>
          </div>
          <div class="eines span2">
            <a tal:condition="python:view.is_community_manager(community)"
               tal:attributes="href string:${community/getURL}/edit">
              <i class="fa-icon-pencil"></i>
            </a>
            <a class="favorite" href="#"
               tal:attributes="data-community string:${community/getURL}">
              <i tal:attributes="class python:view.get_star_class(community)"></i>
            </a>
          </div>
        </div>
      </li>
    </tal:community>
  </ul>
</section>

<div class="clearfix">
  <div class="btn-group pull-right">
    <button class="btn sort" data-sort="data-name" data-order="asc"><i class="fa-icon-arrow-up"></i></button>
    <button class="btn sort" data-sort="data-name" data-order="desc"><i class="fa-icon-arrow-down"></i></button>
    <button class="btn sort" data-sort="default" data-order="desc"><i class="fa-icon-bullseye"></i></button>
  </div>
</div>
