<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<head>
    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border',1);
                             disable_column_one python:request.set('disable_plone.leftcolumn',1);
                             disable_column_two python:request.set('disable_plone.rightcolumn',1);" />
</head>

<body>

<tal:comment replace="nothing">
    Please note that this template fills the "content" slot instead of the
    "main" slot, this is done so we can provide stuff like the content
    tabs. This also means that we have to supply things that are normally
    present from main_template.
</tal:comment>

<metal:main fill-slot="content">
    <tal:main-macro metal:define-macro="main"
                    tal:define="username view/username;
                                mtool python: context.portal_membership;
                                portrait python: mtool.getPersonalPortrait(username);
                                portal_types context/portal_types;
                                userinfo python: mtool.getMemberInfo(username);
                                userinfo_email view/getEmail;
                                portal_url context/@@plone_portal_state/navigation_root_url;
                                here_url context/@@plone_context_state/object_url;
                                member context/@@plone_portal_state/member;
                                portal context/@@plone_portal_state/portal;
                                email_from_address portal/email_from_address">
<!-- <tal:repl tal:replace="username"></tal:repl> -->
      <tal:noAuthor condition="not: userinfo">
          <dl class="portalMessage error">
              <dt i18n:translate="">
                  Error
              </dt>
              <dd i18n:domain="plone" i18n:translate="text_no_user_by_name">
                  No user by that name.
              </dd>
          </dl>
          <div id="content">
              &nbsp;
          </div>
      </tal:noAuthor>

      <tal:haveAuthor condition="userinfo"
          tal:define="isOwner python:member.getId()==username;
                      isAnon context/@@plone_portal_state/anonymous;">

          <div metal:use-macro="context/global_statusmessage/macros/portal_message">
              Portal status message
          </div>

          <div id="content">
              <!-- Author information -->
              <h1 class="documentFirstHeading" tal:condition="userinfo/fullname" tal:content="userinfo/fullname">
                  Author name
              </h1>

              <h1 class="documentFirstHeading" tal:condition="not: userinfo/fullname" tal:content="username">
                  Author ID
              </h1>

              <div id="content-core">
                <div class="row-fluid">
                  <div class="span3">
                    <div class="row-fluid">
                        <div class="photo span12">
                            <a tal:attributes="href string:${view/portal_url}/@@personal-information">
                                <img tal:attributes="src string:${view/portal_url}/@@avatar/${view/username}" alt="User" >
                            </a>
                        </div>
                    </div>
                    <div class="row-fluid">
                      <div class="badges span12">
                          <tal:block repeat="badge view/get_badges">
                              <div class="box_badges">
                                      <img tal:attributes="src python:'{}/{}.png'.format(view.portal_url(), badge['png']) if badge['awarded'] else '{}/++ulearn++static/images/{}-alt.png'.format(view.portal_url(), badge['png'])" />
                              </div>
                          </tal:block>
                      </div>
                    </div>
                  </div>

                  <div class="span9">

                    <tal:bio condition="userinfo/description">
                      <h2 i18n:translate="biografia">Biography</h2>
                      <p tal:content="userinfo/description"></p>
                    </tal:bio>

                    <tal:mail condition="userinfo/has_email">
                      <h2 i18n:translate="eMail">eMail</h2>
                      <p tal:content="userinfo_email"></p>
                    </tal:mail>

                    <tal:location condition="userinfo/location">
                      <h2 i18n:translate="location">Location</h2>
                      <p tal:content="userinfo/location"></p>
                    </tal:location>

                    <tal:homepage condition="userinfo/home_page">
                      <h2 i18n:translate="homepage">Homepage</h2>
                      <p>
                        <a href="#"
                           rel="nofollow"
                           tal:attributes="href userinfo/home_page"
                           i18n:translate="label_author_external_home_page">Author's external home page&hellip;</a>
                      </p>
                    </tal:homepage>

                  </div>
                </div>

              </div>
          </div>

        </tal:haveAuthor>

    </tal:main-macro>

</metal:main>

</body>
</html>
